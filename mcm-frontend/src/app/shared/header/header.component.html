<header class="nav">
  <a class="brand" routerLink="/" (click)="closeMenu()">
    <img class="brand-logo" src="assets/mcm-mark.png" alt="MCM" />
    <div class="brand-text">
      <div class="brand-name">MCM</div>
      <div class="brand-sub">Modular Computing Market</div>
    </div>
  </a>

  <div class="search" *ngIf="!hideSearch">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (keyup.enter)="onSearch()"
      placeholder="Keresés (pl. FIFA, RTX, Steam…)"
      aria-label="Keresés"
    />
    <button type="button" class="btn" (click)="onSearch()">Keresés</button>
  </div>

  <nav class="links">
    <ng-container *ngIf="!auth.isLoggedIn; else logged">
      <a class="link" routerLink="/login">Belépés</a>
      <a class="btn primary" routerLink="/register">Regisztráció</a>
    </ng-container>

    <ng-template #logged>
      <button type="button" class="profile-btn" (click)="toggleMenu()" aria-haspopup="menu" [attr.aria-expanded]="menuOpen">
        <span class="avatar" aria-hidden="true">{{ (auth.profile?.username || 'U')[0] | uppercase }}</span>
        <span class="profile-label">{{ auth.profile?.username }}</span>
        <span class="chev" aria-hidden="true">▾</span>
      </button>

      <div class="menu" *ngIf="menuOpen" (mouseleave)="closeMenu()">
        <div class="menu-head" *ngIf="auth.profile as p">
          <div class="menu-user">{{ p.username }}</div>
          <div class="menu-email">{{ p.email }}</div>
        </div>
        <a routerLink="/profile" (click)="closeMenu()">Profil</a>
        <button type="button" (click)="logout()">Kijelentkezés</button>
      </div>
    </ng-template>
  </nav>
</header>
